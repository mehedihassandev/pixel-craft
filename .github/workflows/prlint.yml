name: PR Linting

on:
    pull_request:
        branches:
            - develop
            - main
        types: ["opened", "edited", "reopened", "synchronize"]

jobs:
    commitlint:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout code
              uses: actions/checkout@v4
              with:
                  fetch-depth: 0

            - name: Set up Node.js
              uses: actions/setup-node@v4
              with:
                  node-version: "18"
                  cache: "npm"

            - name: Install dependencies
              run: npm ci

            - name: Run commitlint
              run: |
                  npx commitlint --from=${{ github.event.pull_request.base.sha }} --to=${{ github.event.pull_request.head.sha }} --verbose

    prlint-reloaded:
        runs-on: ubuntu-latest

        steps:
            - uses: maor-rozenfeld/prlint-reloaded@v1
              with:
                  title-regex: ^NE-\d+:.[A-Z][a-z]+
                  error-message: Your title must be in the format.

            - uses: maor-rozenfeld/prlint-reloaded@v1
              with:
                  title-regex: ^\S+\s+\S+\s+\S+
                  error-message: Your title must have at least three words

            - uses: maor-rozenfeld/prlint-reloaded@v1
              with:
                  title-regex: ^(?!\S+ing\s)(?!\S+ed\s)
                  error-message: Use imperative mood (i.e write "Fix", not "Fixed" or "Fixing")
